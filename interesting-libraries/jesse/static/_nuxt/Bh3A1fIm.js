import{c as p,o as l,b as a,g as Y,r as x,a3 as xe,d as r,F as Z,p as de,k as L,w,a5 as pe,m as ue,D as n,t as q,a6 as ge,a7 as Re,H as Oe,S as Be,q as ne,K as F,aW as $e,b4 as G,O as te,a0 as N,a4 as we,h as C,E as B,e as Te,a$ as Ne,b0 as Ce,Z as De,b5 as ze,aX as Fe,a as qe,aG as He,aH as We,aI as Ye,b6 as Ze,aT as Ge,aD as Qe,aE as ve,s as Je,M as Ke,i as W,v as Ve,x as Xe,G as ye,l as T,V as et,T as be,W as ee,Y as tt,$ as st}from"./Jjv4biHX.js";import{a as ot,r as rt}from"./CuAiSJsa.js";import{b as Le,T as nt,r as he,_ as lt,a as at,c as it,e as ut,d as dt}from"./DZGdZ9Vo.js";import{_ as ct}from"./BAji6k9Y.js";import{_ as mt}from"./Bqh70iPl.js";import{_ as ft}from"./D12Iixl-.js";import{l as pt,d as gt,s as _e,_ as vt}from"./BJ0SAP-Q.js";import{u as yt}from"./COsusUvM.js";import"./HD0P4N3A.js";function ke(S,o){return l(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"})])}function bt(S,o){return l(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122"})])}const ht={base:"animate-pulse",background:"bg-gray-100 dark:bg-gray-800",rounded:"rounded-md"},_t={class:"mb-4"},kt={class:""},xt={class:"relative rounded-lg shadow flex divide-x divide-gray-200 dark:divide-gray-700","aria-label":"Tabs"},$t=["to","onClick"],wt=["onClick"],Tt=["onClick"],Ct={class:"absolute right-[1em] focus:outline-none"},Vt=Y({__name:"LiveTabs",props:{currentTab:{},tabs:{}},emits:["close","cancel"],setup(S,{emit:o}){const _=xe(),g=x(_.params.id),v=x(!1),s=x(!1),V=x(null),y=x(null),c=o;function i(u){if(Object.keys(G().tabs).length>=te().planLimits.live_trading_tabs){N("error",`You have reached the limit of "${te().planLimits.live_trading_tabs}" tabs for your "${te().plan}" plan. Please upgrade your plan to add more tabs.`);return}G().addTab(u)}function $(u){we().push(`/live/${u}`)}function U(u){if(!u.form.routes.length)return"New Tab";if(u.results.exception.error&&u.results.monitoring)return"Error";const m=u.form.routes[0];let f="";const M=u.form.exchange;return M&&(f+=`${M} â€¢ `),m.strategy&&(f+=`${m.strategy} â€¢ `),m.symbol&&(f+=`${m.symbol} â€¢ `),m.timeframe&&(f+=`${m.timeframe}`),f=f.endsWith(" â€¢ ")?f.slice(0,-3):f,u.results.monitoring&&!u.results.finished?`ðŸŸ¢ ${f}`:u.results.exception.error&&u.results.monitoring?`ðŸ”´ ${f}`:u.results.showResults?`${f} | Results`:f}function E(u){V.value=u.id,u.results.exception.error||u.results.finished||u.results.booting?v.value=!0:c("close",V.value)}return(u,m)=>{const f=Be,M=ne,H=$e;return l(),p("div",_t,[a("div",kt,[a("nav",xt,[(l(!0),p(Z,null,de(u.tabs,h=>(l(),L(f,{key:h.id,class:"relative group min-w-0 flex-1 overflow-hidden text-center flex items-center",text:U(h),"open-delay":700,onMouseup:Oe(D=>E(h),["middle"])},{default:w(()=>[a("div",{to:`/live/${h.id}`,class:ue([h.id===n(g)?"text-gray-900 dark:text-gray-100 font-bold ":"text-gray-500 dark:text-gray-300 hover:text-gray-700 font-medium ","whitespace-nowrap py-3 px-4 inline-block select-none cursor-pointer focus:outline-none w-full text-xs bg-gray-50 dark:bg-backdrop-dark"]),onClick:D=>$(h.id)},[a("span",null,q(U(h)),1),a("span",{"aria-hidden":"true",class:ue([h.id===n(g)&&Object.keys(u.tabs).length>1?"bg-indigo-400":"bg-transparent dark:bg-gray-600","absolute inset-x-0 bottom-0 h-0.5"])},null,2)],10,$t),(h.results.booting||h.results.monitoring)&&!h.results.finished?pe((l(),p("button",{key:0,class:"absolute right-[0.5em] focus:outline-none",onClick:D=>{s.value=!0,y.value=h.id}},[r(n(ot),{class:"h-5 w-5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 hover:bg-gray-200 bg-gray-100 dark:bg-gray-700 rounded-full","aria-hidden":"true"})],8,wt)),[[ge,Object.keys(u.tabs).length>1]]):pe((l(),p("button",{key:1,class:"hidden md:block absolute right-[0.5em] focus:outline-none",onClick:D=>E(h)},[r(n(Re),{class:"h-5 w-5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 hover:bg-gray-200 bg-gray-100 dark:bg-gray-700 rounded-full","aria-hidden":"true"})],8,Tt)),[[ge,Object.keys(u.tabs).length>1]])]),_:2},1032,["text","onMouseup"]))),128)),r(f,{text:"New Tab",popper:{arrow:!0}},{default:w(()=>[a("div",{class:"select-none cursor-pointer text-gray-400 dark:text-gray-100 hover:text-gray-600 focus:outline-none group relative w-14 overflow-hidden bg-gray-50 dark:bg-backdrop-dark py-3 px-4 font-medium hover:bg-gray-50 dark:hover:bg-gray-800 flex items-center justify-center",onClick:m[0]||(m[0]=h=>i(u.currentTab))},[a("button",Ct,[r(n(rt),{class:"h-6 w-6 rounded-full","aria-hidden":"true"})]),m[5]||(m[5]=a("span",{"aria-hidden":"true",class:"absolute inset-x-0 bottom-0 h-0.5 bg-transparent dark:bg-gray-600"},null,-1))])]),_:1})])]),r(H,{modelValue:n(s),"onUpdate:modelValue":m[2]||(m[2]=h=>F(s)?s.value=h:null),title:"Termination Confirm",description:"Are you sure you want to terminate this session?",type:"info"},{default:w(()=>[r(M,{variant:"solid",color:"red",class:"flex justify-center",label:"Terminate",onClick:m[1]||(m[1]=h=>{c("cancel",n(y)),s.value=!1})})]),_:1},8,["modelValue"]),r(H,{modelValue:n(v),"onUpdate:modelValue":m[4]||(m[4]=h=>F(v)?v.value=h:null),title:"Close Live Tab Confirm",description:"Are you sure you want to close this tab?",cancelBtnContent:"cancel",type:"info"},{default:w(()=>[r(M,{variant:"solid",color:"red",class:"flex justify-center",label:"Close",onClick:m[3]||(m[3]=h=>{c("close",n(V)),v.value=!1})})]),_:1},8,["modelValue"])])}}}),Lt=Y({__name:"LiveOrders",props:{orders:{}},setup(S){const o=S,_=C(()=>{if(!o.orders.length)return[];const g=[];for(let v=o.orders.length-1;v>=0;v--){const s=o.orders[v];g.push([{value:s.id.slice(-12),style:"text-xs",tooltip:s.id,tag:"code"},{value:B.timestampToTimeOnly(s.created_at),style:"text-xs",tooltip:B.timestampToTime(s.created_at)},{value:s.symbol,style:"text-xs"},{value:s.type,style:"text-xs"},{value:s.side,style:B.colorBasedOnSide(s.side)},{value:s.price,style:"text-xs"},{value:s.qty,style:B.colorBasedOnSide(s.side)},{value:s.status,style:"text-xs"}])}return g});return(g,v)=>{const s=Le,V=ct;return n(_).length?(l(),L(s,{key:0,data:n(_),"header-items":["ID","Created","Symbol","Type","Side","Price","QTY","Status"],header:""},null,8,["data"])):(l(),L(V,{key:1}))}}}),St={class:"flex justify-end item-center"},Pt={class:"flex justify-end"},It=Y({__name:"ReportLiveSession",props:{session:{}},emits:["close"],setup(S,{emit:o}){const _=o,g=x(!1),v=S,s=x({description:"",email:""}),V=()=>{_("close")},y=async()=>{if(g.value=!0,!s.value.description){N("error","Please enter a description."),g.value=!1;return}const{data:c,error:i}=await Fe("/system/report-exception",{description:s.value.description,email:s.value.email,traceback:"manual report",mode:"live",attach_logs:!0,session_id:v.session},!0);if(g.value=!1,i.value&&i.value.statusCode!==200){N("error",`[${i.value.statusCode}]: ${i.value.statusText}`);return}const $=c.value;$.status==="success"?(s.value.description="",s.value.email="",N("success",$.message),V()):$.status==="error"&&N("error",$.message)};return(c,i)=>{const $=De,U=Ce,E=ze,u=ne,m=Ne;return l(),p(Z,null,[i[5]||(i[5]=a("p",null," If you think something is wrong with your running live session, you can submit a report. By submitting this form, the logs of this session will be sent to Jesse's developers so we can see what's going on. ",-1)),i[6]||(i[6]=a("br",null,null,-1)),i[7]||(i[7]=a("p",null,[Te("Your exchange API keys and strategies are safe and "),a("b",null,"are never sent to us.")],-1)),i[8]||(i[8]=a("br",null,null,-1)),r(m,{state:n(s),class:"space-y-4",onSubmit:y},{default:w(()=>[r(U,{label:"Email (optional)",help:"Enter your email address for us to know who sent the email and possibly reply back to you."},{default:w(()=>[r($,{modelValue:n(s).email,"onUpdate:modelValue":i[0]||(i[0]=f=>n(s).email=f),placeholder:"Email address...",type:"email"},null,8,["modelValue"])]),_:1}),i[3]||(i[3]=a("br",null,null,-1)),r(U,{label:"Description:",name:"Description"},{default:w(()=>[r(E,{modelValue:n(s).description,"onUpdate:modelValue":i[1]||(i[1]=f=>n(s).description=f),rows:10,placeholder:"Describe what you think is wrong in this session..."},null,8,["modelValue"])]),_:1}),i[4]||(i[4]=a("br",null,null,-1)),a("div",St,[a("div",Pt,[r(u,{color:"gray",variant:"link",class:"mr-8",label:"Cancel",onClick:i[2]||(i[2]=f=>V())}),r(u,{type:"submit",class:"w-48 flex justify-center",label:"Submit",loading:n(g),disabled:n(g)},null,8,["loading","disabled"])])])]),_:1},8,["state"])],64)}}}),Et=Qe(ve.ui.strategy,ve.ui.skeleton,ht),jt=Y({inheritAttrs:!1,props:{class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(S){const{ui:o,attrs:_}=We("skeleton",Ye(S,"ui"),Et),g=C(()=>Ze(Ge(o.value.base,o.value.background,o.value.rounded),S.class));return{ui:o,attrs:_,skeletonClass:g}}});function Ut(S,o,_,g,v,s){return l(),p("div",He({class:S.skeletonClass},S.attrs),null,16)}const Mt=qe(jt,[["render",Ut]]),At={class:"mb-16"},Rt={key:0,class:"rounded overflow-hidden border-2 border-gray-100 dark:border-gray-600 p-4"},Ot={key:1},Bt=Y({__name:"CandlesChart",props:{form:{},results:{}},setup(S){const o=Je(),_=C(()=>Ke().params.id),g=x(!0),v=x(2),s=S,V=x();let y=null,c=null;const i={orderEntries:{},positionEntry:null},$=C(()=>o.value),U=s.form.exchange,E=C(()=>`${U}-${s.results.selectedRoute.symbol}-${s.results.selectedRoute.timeframe}`),u=C(()=>s.results.currentCandles),m=C(()=>{const b=s.results.positions.find(k=>k[0].value===s.results.selectedRoute.symbol);return b===void 0?[]:b}),f=C(()=>m.value[2].value),M=C(()=>Number(m.value[1].value)>0?"long":Number(m.value[1].value)<0?"short":"close");W($,b=>{re(b)}),W(f,(b,k)=>{c!==null&&b!==k&&D()}),W(()=>s.results.orders,()=>{c!==null&&se()},{deep:!0}),W(u,(b,k)=>{c!==null&&oe(b[E.value],b[E.value])}),Ve(async()=>{setTimeout(async()=>{await H()},200)});async function H(){g.value=!0,await G().fetchCandles(_.value),g.value=!1,_e.width=V.value.clientWidth,y=nt(V.value,_e),y.applyOptions({watermark:{visible:!0,fontSize:16,horzAlign:"left",vertAlign:"bottom",color:"#888",text:`${s.results.selectedRoute.symbol} â€¢ ${s.results.selectedRoute.timeframe}`}}),c=y.addCandlestickSeries(),c.setData(s.results.candles),y.timeScale().fitContent(),c.applyOptions({priceFormat:{type:"price",precision:v.value,minMove:.01}}),oe(s.results.candles[0],s.results.candles[1]),D(),se(),re($.value)}Xe(()=>{h()});function h(){y!==null&&(y.remove(),y=null),c&&(c=null)}function D(){const b=M.value==="long"?"#00AB5C":"#FF497D";if(i.positionEntry&&c.removePriceLine(i.positionEntry),Number(f.value)>0){const k={price:Number(f.value),color:b,lineWidth:1,lineStyle:0,axisLabelVisible:!0,title:"Entry Price"};i.positionEntry=c.createPriceLine(k)}}function se(){const b=m.value[0].value;for(const k in i.orderEntries)c.removePriceLine(i.orderEntries[k]),delete i.orderEntries[k];s.results.orders.forEach(k=>{const I=k.side==="buy"?"#00AB5C":"#FF497D",z=ye.startCase(ye.lowerCase(`${k.side} ${k.type}`));if((k.status==="ACTIVE"||k.status==="QUEUED")&&k.symbol===b){const j={price:Number(k.price),color:I,lineWidth:1,lineStyle:0,axisLabelVisible:!0,title:z};i.orderEntries[k.id]=c.createPriceLine(j)}})}function oe(b,k){if(b===void 0)throw new TypeError("candle is undefined!");if(s.results.candles.length===0)return;const I=String(b.open).indexOf("."),z=I===-1?0:String(b.open).length-I-1,j=String(k.open).indexOf("."),Q=j===-1?0:String(k.open).length-j-1,J=z>Q?z:Q;v.value=J,(v.value<0||v.value>100)&&(v.value=0),c.applyOptions({priceFormat:{type:"price",precision:v.value,minMove:Math.pow(10,-J).toFixed(J)}}),c.update(s.results.currentCandles[E.value])}function re(b){y!==null&&y.applyOptions(b==="light"?pt.chart:gt.chart)}function le(b){s.results.selectedRoute=b,h(),H()}return(b,k)=>{const I=Mt,z=ne;return l(),p("div",At,[n(g)?(l(),p("div",Rt,[r(I,{class:"h-4 w-full mb-4"}),r(I,{class:"h-4 w-2/3 mb-4"}),r(I,{class:"h-4 w-1/2 mb-4"}),r(I,{class:"h-4 w-full mb-4"}),r(I,{class:"h-4 w-full mb-4"}),r(I,{class:"h-4 w-2/3 mb-4"}),r(I,{class:"h-4 w-full mb-4"}),r(I,{class:"h-4 w-full"})])):T("",!0),a("div",{ref_key:"chartContainer",ref:V,class:ue({"rounded overflow-hidden border-2 border-gray-100 dark:border-gray-600":!n(g)})},null,2),s.form.routes.length>1?(l(),p("div",Ot,[(l(!0),p(Z,null,de(s.form.routes,j=>(l(),L(z,{key:j.symbol,variant:"soft",color:"gray",disabled:b.results.selectedRoute.symbol===j.symbol&&b.results.selectedRoute.timeframe===j.timeframe,class:"mt-2 mr-2",onClick:Q=>le(j)},{default:w(()=>[Te(q(j.symbol)+" â€¢ "+q(j.timeframe),1)]),_:2},1032,["disabled","onClick"]))),128))])):T("",!0)])}}}),Nt={key:0,class:"flex flex-col items-center justify-center select-none mt-[10%]"},Dt=["textContent"],zt={class:"mt-8"},Ft={key:1,class:"mx-auto container mt-8"},qt={key:0,"data-cy":"live-page-content"},Ht={class:"flex justify-between items-center"},Wt={class:"grid grid-cols-1 gap-6"},Yt={class:"flex justify-between items-center"},Zt={key:1},Gt={key:0,class:"mb-8"},Qt={key:0},Jt={key:0,class:"mt-8 lg:mt-0"},Kt={key:1,"data-cy":"live-action-button"},Xt={key:1,class:"my-8 border-2 dark:border-gray-600 rounded-full"},es={key:2,class:"bg-white dark:bg-gray-700 grid grid-cols-1 gap-6 border dark:border-gray-600 rounded py-4 px-6 select-none"},ts={class:"text-sm font-medium text-gray-500 dark:text-gray-400 truncate"},ss={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},os={class:"flex justify-between items-center"},rs={class:"flex justify-start items-center"},ns={class:"focus:outline-none flex justify-start items-center"},ls={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},as={class:"flex justify-between items-center"},is={class:"flex justify-start items-center"},us={class:"focus:outline-none flex justify-start items-center"},ds={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},cs={key:3},ms=Y({__name:"LiveTab",props:{form:{},results:{},session:{},tabs:{}},setup(S){const o=S,_=x([]),g=x(!1),v=x(!1),s=x(!1),V=x(!1),y=x(!1),c=x(!1),i=x(!1),$=x(!1),U=x(!1),E=x(!1),u=te(),m=G(),f=x([]);async function M(){if(!(o.results.monitoring||o.results.booting)){if(!o.form.paper_mode){const e=u.exchangeApiKeys.find(t=>t.id===o.form.exchange_api_key_id);e&&(o.form.exchange=e.exchange)}try{f.value=await te().getExchangeSupportedSymbols(o.form.exchange);for(let e=0;e<o.form.routes.length;e++)f.value.includes(o.form.routes[e].symbol)||(o.form.routes[e].symbol=f.value[0]);if(o.form.data_routes.length>0)for(let e=0;e<o.form.data_routes.length;e++)f.value.includes(o.form.data_routes[e].symbol)||(o.form.data_routes[e].symbol=f.value[0])}catch(e){console.error("Error updating supported symbols:",e)}}}Ve(async()=>{setTimeout(async()=>{o.form.exchange&&(!o.results.monitoring&&!o.results.booting||!f.value.length)&&await M()},200)}),W(()=>o.form.exchange,async(e,t)=>{e!==t&&await M()}),W(()=>o.results.monitoring,async e=>{e==!1&&await M()},{deep:!0}),W(()=>o.form.exchange_api_key_id,async(e,t)=>{e!==t&&await M()});const H=C(()=>{const e=[{label:"Exchange",value:o.results.generalInfo.exchange},{label:"Current Time",value:B.timestampToTime(o.results.generalInfo.current_time)},{label:"Debug Mode",value:o.results.generalInfo.debug_mode},{label:"Paper Trade",value:o.results.generalInfo.paper_mode},{label:"PNL",value:`${o.results.generalInfo.pnl} (${o.results.generalInfo.pnl_perc}%)`},{label:"Started",value:B.timestampToTime(o.results.generalInfo.started_at)},{label:"Started/Current Balance",value:`${o.results.generalInfo.started_balance} / ${o.results.generalInfo.current_balance}`},{label:"Trades",value:`${o.results.generalInfo.count_trades}`}];return o.results.generalInfo.leverage_type!=="spot"&&(e.push({label:"Available Margin",value:`${o.results.generalInfo.available_margin}`}),e.push({label:"Leverage",value:`${o.results.generalInfo.leverage}x (${o.results.generalInfo.leverage_type})`})),e}),h=C(()=>u.notificationApiKeys.map(e=>({label:`${e.name} - ${e.driver}`,value:e.id}))),D=C(()=>Math.round(o.results.progressbar.estimated_remaining_seconds)===0?"Please wait...":`${Math.round(o.results.progressbar.estimated_remaining_seconds)} seconds remaining...`),se=C(()=>{if(!o.results.orders)return[];const e=[],t=5,A=o.results.orders.length,R=A-t>=0?A-t:0;for(let K=A-1;K>=R;K--){const P=o.results.orders[K],O=P.status==="PARTIALLY FILLED"?`${P.filled_qty}/${P.qty}`:P.qty;e.push([{value:B.timestampToTimeOnly(P.created_at),style:"text-xs",tooltip:B.timestampToTime(P.created_at)},{value:P.symbol,style:"text-xs"},{value:P.type,style:"text-xs"},{value:P.side,style:B.colorBasedOnSide(P.side)},{value:P.price,style:"text-xs"},{value:O,style:B.colorBasedOnSide(P.side)},{value:P.status,style:"text-xs"}])}return e}),oe=C(()=>{let e=[];const t=u.jesseSupportedTimeframes;return u.settings.live.generate_candles_from_1m||!o.form.exchange?e=t.map(A=>u.planLimits.timeframes.includes(A)?{label:A,value:A,disabled:!1}:{label:`${A} (Upgrade required)`,value:A,disabled:!0}):e=u.exchangeInfo[o.form.exchange].supported_timeframes.map(R=>u.planLimits.timeframes.includes(R)?{label:R,value:R,disabled:!1}:{label:`${R} (Upgrade required)`,value:R,disabled:!0}),e}),re=C(()=>u.liveTradingExchangeNames.map(e=>u.planLimits.exchanges.includes(e)?{label:e,value:e,disabled:!1}:{label:`${e} (Upgrade required)`,value:e,disabled:!0})),le=C(()=>u.exchangeApiKeys.map(e=>u.planLimits.exchanges.includes(e.exchange)?{label:`${e.exchange} - ${e.name}`,value:e.id,disabled:!1}:{label:`${e.exchange} - ${e.name} (Upgrade required)`,value:e.id,disabled:!0})),b=m.cancel,k=m.newLive;function I(e){if(_.value.length){for(let t=0;t<_.value.length;t++)N("error",_.value[t]);return}if(o.form.paper_mode&&!o.form.exchange||!o.form.paper_mode&&o.form.exchange_api_key_id===""){N("error","Please select an exchange");return}m.start(e)}function z(e){m.closeTab(e)}function j(e){E.value=!1,m.stop(e)}function Q(){v.value=!0,navigator.clipboard.writeText(o.results.infoLogs),N("success","Logs copied successfully"),V.value=!0,setTimeout(()=>{V.value=!1},3e3)}function J(){s.value=!0,navigator.clipboard.writeText(o.results.errorLogs),N("success","Logs copied successfully"),y.value=!0,setTimeout(()=>{y.value=!1},3e3)}const ce=C(()=>["basic","pro","enterprise","basic-lifetime","pro-lifetime","enterprise-lifetime","lifetime"].includes(u.plan));return(e,t)=>{const A=Lt,R=et,K=It,P=mt,O=ne,Se=$e,Pe=lt,me=at,X=tt,ae=ft,Ie=it,fe=st,Ee=Ce,je=Bt,ie=Le,Ue=ut,Me=vt,Ae=dt;return l(),p(Z,null,[r(R,{modelValue:n(c),"onUpdate:modelValue":t[0]||(t[0]=d=>F(c)?c.value=d:null),size:"ultra",title:"Orders"},{default:w(()=>[r(A,{orders:e.results.orders},null,8,["orders"])]),_:1},8,["modelValue"]),r(R,{modelValue:n(i),"onUpdate:modelValue":t[2]||(t[2]=d=>F(i)?i.value=d:null),size:"small",title:"Report An Issue"},{default:w(()=>[r(K,{session:e.session,onClose:t[1]||(t[1]=d=>i.value=!1)},null,8,["session"])]),_:1},8,["modelValue"]),r(R,{modelValue:n($),"onUpdate:modelValue":t[3]||(t[3]=d=>F($)?$.value=d:null),title:"Info Logs"},{default:w(()=>[r(P,{logs:e.results.infoLogs},null,8,["logs"])]),buttons:w(()=>[a("button",{class:"ml-2 p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:Q},[n(V)?(l(),L(n(be),{key:0,class:"h-6 w-6","aria-hidden":"true"})):T("",!0),!n(V)&&e.results.infoLogs.length!=0?(l(),L(n(he),{key:1,class:"h-6 w-6","aria-hidden":"true"})):T("",!0)])]),_:1},8,["modelValue"]),r(R,{modelValue:n(U),"onUpdate:modelValue":t[4]||(t[4]=d=>F(U)?U.value=d:null),title:"Error Logs"},{default:w(()=>[r(P,{logs:e.results.errorLogs},null,8,["logs"])]),buttons:w(()=>[a("button",{class:"ml-2 p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:J},[n(y)?(l(),L(n(be),{key:0,class:"h-6 w-6","aria-hidden":"true"})):T("",!0),!n(y)&&e.results.errorLogs.length!=0?(l(),L(n(he),{key:1,class:"h-6 w-6","aria-hidden":"true"})):T("",!0)])]),_:1},8,["modelValue"]),r(Se,{modelValue:n(E),"onUpdate:modelValue":t[6]||(t[6]=d=>F(E)?E.value=d:null),title:"Termination Confirm",description:"Are you sure you want to terminate this session?",type:"info"},{default:w(()=>[r(O,{variant:"solid",color:"red",class:"flex justify-center",label:"Terminate",onClick:t[5]||(t[5]=d=>j((e._.provides[ee]||e.$route).params.id))})]),_:1},8,["modelValue"]),e.results.booting?(l(),p("div",Nt,[a("div",null,[r(Pe,{progress:e.results.progressbar.current},null,8,["progress"])]),e.results.exception.error?T("",!0):(l(),p("h3",{key:0,class:"mt-8 animate-pulse",textContent:q(n(D))},null,8,Dt)),a("div",zt,[e.form.debug_mode?(l(),L(O,{key:0,icon:"i-heroicons-clipboard-document-list",variant:"solid",label:"View Logs",size:"xl",class:"flex justify-center w-64",onClick:t[7]||(t[7]=d=>$.value=!0)})):T("",!0),r(O,{color:"gray",class:"w-64 flex justify-center mt-4",size:"xl",ui:{color:{gray:{solid:"text-rose-500 dark:text-rose-400"}}},icon:"i-heroicons-no-symbol",variant:"solid",label:"Cancel",trailing:!1,onClick:t[8]||(t[8]=d=>n(b)((e._.provides[ee]||e.$route).params.id))})]),e.results.exception.error?(l(),p("div",Ft,[r(me,{modelValue:n(g),"onUpdate:modelValue":t[9]||(t[9]=d=>F(g)?g.value=d:null),title:e.results.exception.error,content:e.results.exception.traceback,mode:"live","debug-mode":e.form.debug_mode},null,8,["modelValue","title","content","debug-mode"])])):T("",!0)])):(l(),L(Ae,{key:1},{left:w(()=>[!e.results.booting&&!e.results.monitoring&&!e.results.showResults?(l(),p("div",qt,[r(X,{class:"mb-4",title:"Exchange"}),e.form.paper_mode?(l(),L(ae,{key:0,modelValue:e.form.exchange,"onUpdate:modelValue":t[10]||(t[10]=d=>e.form.exchange=d),placeholder:"Select an exchange...",searchable:"",options:n(re),"value-attribute":"value",size:"lg",class:"mt-2 mb-16"},null,8,["modelValue","options"])):(l(),L(ae,{key:1,modelValue:e.form.exchange_api_key_id,"onUpdate:modelValue":t[11]||(t[11]=d=>e.form.exchange_api_key_id=d),placeholder:"Select an exchange...",searchable:"",options:n(le),"value-attribute":"value",size:"lg",class:"mt-2 mb-16"},{empty:w(()=>[a("div",Ht,[t[23]||(t[23]=a("span",null," No exchange API keys found. Please add at least one: ",-1)),r(O,{to:"/exchange-api-keys",icon:"i-heroicons-plus",type:"link",variant:"solid",size:"sm",label:"Add Exchange API Key"})])]),_:1},8,["modelValue","options"])),r(Ie,{"total-routes-error":n(_),form:e.form,results:e.results,mode:"live",symbols:n(f),timeframes:n(oe)},null,8,["total-routes-error","form","results","symbols","timeframes"]),r(X,{class:"mt-16 mb-4",title:"Options"}),a("div",Wt,[r(fe,{modelValue:e.form.debug_mode,"onUpdate:modelValue":t[12]||(t[12]=d=>e.form.debug_mode=d),title:"Debug Mode",description:"Logs more details, helpful for debugging."},null,8,["modelValue"]),r(fe,{modelValue:e.form.paper_mode,"onUpdate:modelValue":t[13]||(t[13]=d=>e.form.paper_mode=d),title:"Paper Trade",disabled:!n(ce),"disabled-guide":n(ce)?"":"Premium plan required",description:"Trade in real-time using actual exchange data with PAPER money."},null,8,["modelValue","disabled","disabled-guide"]),r(Ee,{label:"Notifications:",help:"Select a notification driver to receive notifications"},{default:w(()=>[r(ae,{modelValue:e.form.notification_api_key_id,"onUpdate:modelValue":t[14]||(t[14]=d=>e.form.notification_api_key_id=d),placeholder:"Select a notification driver",size:"lg",options:n(h),"value-attribute":"value"},{empty:w(()=>[a("div",Yt,[t[24]||(t[24]=a("span",null," No notification API keys found. Please add at least one: ",-1)),r(O,{to:"/notification-api-keys",icon:"i-heroicons-plus",type:"link",variant:"solid",size:"sm",label:"Add Notification API Key"})])]),_:1},8,["modelValue","options"])]),_:1})])])):T("",!0),e.results.monitoring?(l(),p("div",Zt,[e.results.exception.error?(l(),p("div",Gt,[r(me,{title:e.results.exception.error,content:e.results.exception.traceback,mode:"live","debug-mode":e.form.debug_mode},null,8,["title","content","debug-mode"])])):T("",!0),e.results.monitoring&&!e.results.finished&&!e.results.exception.error?(l(),L(je,{key:1,results:e.results,form:e.form,exchange:e.form.exchange},null,8,["results","form","exchange"])):T("",!0),r(X,{class:"mb-4",title:"Routes"}),r(ie,{data:e.results.routes,"header-items":["Symbol","Timeframe","Strategy"],header:""},null,8,["data"]),r(X,{class:"mt-12 mb-4",title:"Positions"}),r(ie,{data:e.results.positions,"header-items":["Symbol","QTY","Entry","Price","Liq Price","PNL"],header:""},null,8,["data"]),r(Ue,{class:"mt-12 mb-4",title:"Orders"},{default:w(()=>[a("button",{type:"button",class:"inline-flex items-center shadow-sm px-4 py-1.5 border border-gray-300 dark:border-gray-900 text-sm leading-5 font-medium rounded-full text-gray-700 dark:text-gray-100 bg-white dark:bg-backdrop-dark hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none",onClick:t[15]||(t[15]=d=>c.value=!0)},[r(n(bt),{class:"-ml-1.5 mr-1 h-5 w-5 text-gray-400","aria-hidden":"true"}),t[25]||(t[25]=a("span",null,"More",-1))])]),_:1}),r(ie,{data:n(se),"header-items":["Created","Symbol","Type","Side","Price","QTY","Status"],header:""},null,8,["data"])])):T("",!0)]),right:w(()=>[e.results.booting?T("",!0):(l(),p("div",Qt,[e.results.monitoring?(l(),p("div",Jt,[e.results.finished?(l(),L(O,{key:0,class:"w-full flex justify-center",variant:"solid",icon:"i-heroicons-plus",size:"xl",label:"New session",onClick:t[16]||(t[16]=d=>n(k)((e._.provides[ee]||e.$route).params.id))})):(l(),L(O,{key:1,class:"w-full flex justify-center",variant:"solid",color:"gray",icon:"i-heroicons-no-symbol",size:"xl",label:e.results.terminating?"Terminating...":"Terminate",ui:{color:{gray:{solid:"text-rose-500 dark:text-rose-400"}}},onClick:t[17]||(t[17]=d=>E.value=!0)},null,8,["label"])),e.results.monitoring||e.results.finished?(l(),L(O,{key:2,class:"w-full flex justify-center mt-4",variant:"solid",color:"gray",icon:"i-heroicons-flag",size:"xl",label:"Report",onClick:t[18]||(t[18]=d=>i.value=!0)})):T("",!0)])):(l(),p("div",Kt,[r(O,{class:"w-full flex justify-center",icon:"i-heroicons-bolt",size:"xl",variant:"solid",label:"Start",trailing:!1,onClick:t[19]||(t[19]=d=>I((e._.provides[ee]||e.$route).params.id))}),Object.keys(e.tabs).length>1?(l(),L(O,{key:0,class:"w-full md:hidden flex justify-center mt-2",icon:"i-heroicons-x-mark",size:"xl",variant:"solid",color:"gray",label:"Close Tab",trailing:!1,onClick:t[20]||(t[20]=d=>z((e._.provides[ee]||e.$route).params.id))})):T("",!0)]))])),e.results.monitoring?(l(),p("hr",Xt)):T("",!0),e.results.monitoring?(l(),p("dl",es,[(l(!0),p(Z,null,de(n(H),d=>(l(),p("div",{key:d.label,class:"flex justify-between items-center"},[a("div",ts,q(d.label)+":",1),a("div",ss,q(d.value),1)]))),128)),a("div",os,[a("div",rs,[a("button",{class:"text-sm font-medium text-gray-500 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300 truncate flex items-center hover:underline cursor-pointer focus:outline-none",onClick:t[21]||(t[21]=d=>$.value=!0)},[t[26]||(t[26]=a("span",null,"Info Logs:",-1)),a("span",ns,[r(n(ke),{class:"w-6 h-6 ml-2"})])])]),a("div",ls,q(e.results.generalInfo.count_info_logs),1)]),a("div",as,[a("div",is,[a("button",{class:"text-sm font-medium text-gray-500 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300 truncate flex items-center hover:underline cursor-pointer focus:outline-none",onClick:t[22]||(t[22]=d=>U.value=!0)},[t[27]||(t[27]=a("span",null,"Error Logs:",-1)),a("span",us,[r(n(ke),{class:"w-6 h-6 ml-2 cursor-pointer"})])])]),a("div",ds,q(e.results.generalInfo.count_error_logs),1)])])):T("",!0),e.results.monitoring&&e.results.watchlist.length?(l(),p("div",cs,[r(X,{class:"mt-8 mb-4",title:"Watch List"}),r(Me,{data:e.results.watchlist},null,8,["data"])])):T("",!0)]),_:1}))],64)}}}),fs={class:"w-full"},$s=Y({__name:"[id]",setup(S){yt({title:"Live/Paper trading - Jesse"});const o=G(),_=C(()=>o.tabs),g=xe(),v=C(()=>g.params.id),s=C(()=>{if(!_.value[v.value]){const y=Object.keys(_.value);if(y.length>0){const c=_.value[y[0]];return we().push(`/live/${c.id}`),c}}return _.value[v.value]});(!Object.keys(s.value).includes("selectedRoute")||Object.keys(s.value.results.selectedRoute).length==0||V(s.value.results.selectedRoute,s.value.form.routes[0]))&&(s.value.results.selectedRoute=s.value.form.routes[0]),s.value.form.exchange==""&&(s.value.form.exchange=s.value.results.generalInfo.exchange),Object.keys(_.value).length===0&&G().addTab();function V(y,c){return y.length!==c.length?!1:y.every((i,$)=>i===c[$])}return(y,c)=>{const i=Vt,$=ms;return l(),p(Z,null,[a("div",fs,[r(i,{"current-tab":s.value?s.value.id:null,tabs:_.value,onClose:n(o).closeTab,onCancel:n(o).cancel},null,8,["current-tab","tabs","onClose","onCancel"])]),s.value?(l(),L($,{key:0,form:s.value.form,results:s.value.results,session:v.value,tabs:_.value},null,8,["form","results","session","tabs"])):T("",!0)],64)}}});export{$s as default};
